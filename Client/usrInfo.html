 <!DOCTYPE html>
 <html>
 <head>
 	<title> KNET DATABASE LINK </title>
 	<link rel="stylesheet" href="/lib/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="default.css">
	<script src="js/normal.js"></script>
	  <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
	  <script src="/lib/bootstrap.js"></script>
 </head>
 <body>
 <div id="controls">
  <button type="button" class="btn btn-default" aria-label="Left Align" onclick="location.href='help.html'">
  <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span>
</button>
<input type="button" class="btn btn-danger" value="logout" onclick="logout()">
</div>
 <div id="header">
 <h1>KNET DATABASE</h1>
 </div>
<ul class="nav">
 <li class="nav"><a href="user.html">Front Page</a></li>
 <li class="nav"><a href="database.html">Database</a></li>
 <li class="nav "><a href="usr.html">User Info</a></li>
 <li class="nav active" id="um" style="display:none"><a href="usrMgmt.html">User Managment</a></li>
  <ul class="">
 <li class="nav active"><a href="usrMgmt.html">User Overview</a></li>
 <li class="nav"><a href="searchUsr.html">Search Users</a></li>
  <li class="nav"><a href="crtUsr.html">Create Users</a></li>
 </ul>
 <li class="nav disabled" id="dash" style="display:none"><a href="dash.html">Dashboard</a></li>
 </ul>
 <div id="content">
<h2 id="userWelcome"> Crunching Data </h2>
<hr>
<div class="inv-box">
<h3>General Information</h3>
<hr>
Name: <input type="text" > <br><br>
E-Mail: <input type="text" > <br> <br>
GSM: <input type="text" > <br> <br>
<input id="attention" type='button' class='btn btn-primary disabled' value='Needs Attention'>
</div>
<div class="inv-box">
<h3>Medals</h3>
<hr>
<input id="admin" type='button' class='btn btn-warning disabled' value='Not Admin' onclick="set('admin')">
<input id="op" type='button' class='btn btn-danger disabled' value='Not Operator' onclick="set('operator')">
<input id="staff" type='button' class='btn btn-info disabled' value='Not Staff' onclick="set('staff')">
<input id="user" type='button' class='btn btn-Success disabled' value='Not User'>
</div>
</div>
 </div>
 </body>
	<script type="text/javascript">
	var att;
	var request;
	var par = window.location.href.slice(41);
		par = JSON.parse('{"' + decodeURI(par.replace(/&/g, "\",\"").replace(/=/g,"\":\"")) + '"}')
	var api = "http://knet.kcorporation.tk/api";
		var write = "<tr id='usrTr'><th>ID</th><th>Name</th><th>Creation date</th><th>Admin</th></tr>";
	var usrName;
		function getAdmin(){
		request("usrPage", "isAdmin", function(admin){
			if(admin == "true")
			{
			document.getElementById("dash").style = "display:block";
			document.getElementById("um").style = "display:block";
		}
		getAttention();
		});
		}
		function getAttention()
		{
			usrReq("usrPage", "usrInfo", par.usrId, function(arr){
				att = JSON.parse(arr);
			document.getElementById("userWelcome").innerHTML = "User Information for: "+att.info.name + " ("+att.cred.id+")"; 
			console.log(att.info.admin);
			if(att.info.admin == "true")
			{
				console.log("admin")
				document.getElementById("admin").className = "btn btn-warning active";
				document.getElementById("admin").value = "ADMIN";
			}
			if(att.info.operator == "true")
			{
				console.log("admin")
				document.getElementById("op").className = "btn btn-danger active";
				document.getElementById("op").value = "OPERATOR";
			}
			if(att.info.staff == "true")
			{
				console.log("admin")
				document.getElementById("staff").className = "btn btn-info active";
				document.getElementById("staff").value = "STAFF";
			}
			if(att.info.user == "true")
			{
				console.log("admin")
				document.getElementById("user").className = "btn btn-Success active";
				document.getElementById("user").value = "USER";
			}
			});
		}
		function render(){
			document.getElementById("usrTbl").innerHTML = write;
		}

		function set(type){
			
			getState(type, function(state){
			if(type == "admin")
			{
			request = {"origin":"crtUsr", "request":"crtUsr", admin:state, name:att.info.name, id:att.cred.id, pass:att.cred.pass, staff:att.info.staff, op:att.info.operator, email:att.info.email, gsm:att.info.gsm}
			}
			if(type == "operator")
			{
			request = {"origin":"crtUsr", "request":"crtUsr", operator:state, name:att.info.name, id:att.cred.id, pass:att.cred.pass, staff:att.info.staff, admin:att.info.admin, email:att.info.email, gsm:att.info.gsm}
			}
			if(type == "staff")
			{
			request = {"origin":"crtUsr", "request":"crtUsr", staff:state, name:att.info.name, id:att.cred.id, pass:att.cred.pass, admin:att.info.admin, op:att.info.operator, email:att.info.email, gsm:att.info.gsm}
			}
			console.log(state);
			data = $.ajax({
			url: api,
			dataType: 'text',
			method: 'get',
			crossDomain: true,
			data: request,
			success: function(data) {
			console.log(data);
			},
			error: function(data) {
			console.log(data);
				
				
			}
		});
		});
		}
		function getState(type, callback)
		{
			if(type == "admin")
			{
				if(att.info.admin == true)
				{
					callback(false)
				}
				else
				{
					callback(true);
				}
			}

			if(type == "operator")
			{
				if(att.info.operator == true)
				{
					callback(false)
				}
				else
				{
					callback(true);
				}
			}

			if(type == "staff")
			{
				if(att.info.staff == true)
				{
					callback(false)
				}
				else
				{
					callback(true);
				}
			}

		}
		getAdmin();
	</script>
 </html>
